require 'sham_rack'

ShamRack.at("<%=service_host%>").sinatra do
<% descriptor.each_pair do |route, verbs| %>
  <% verbs.each_pair do |verb, responses| %>
  <%=verb%> "<%=route%>" do
    case <%=service_class%>Mock.extpected_status
    <% responses.each_pair do |status, response| %>
      <% if status != "default" %>
    when "<%=status%>"
      File.read(<%=service_class%>Mock.fixture_file("<%= response['fixture_path'] %>"))
      <% end %>
    <% end %>
    else
      File.read(<%=service_class%>Mock.fixture_file("<%= Zelig::MockRoute.default_fixture(responses) %>"))
    end
  end
  <% end %>
<% end %>
end
